<!-- templates/polls/analysis.html -->
{% extends 'template.html' %}

{% block title %}WSM | Analysis{% endblock %}
{% block content %}

{% load static %}


  <div class="container mt-20">
    {% if not user.is_authenticated %}
      <p>You are not logged in. Please log in to see this page.</p>
      <a href="{% url 'login' %}">login</a>
    {% else %}
      <p>Hi {{ user.username }}!</p>
      <p>
        <a href="{% url 'logout' %}" class="fill-btn" style="margin: 0; text-decoration: none;">logout</a><br>
        <a href="" class="fill-btn" style="margin: 0; text-decoration: none;">See all</a>
      </p>

      <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <input class="submit-row" type="submit" value="Submit">
      </form>

      <h2>{{date}}</h2>
      
      {%if stat%}
        <div>
          <div class="container">
            <div class="row">
              <div class="col-12">
                <h3 class="text-uppercase text-center">Here's how you slept on</h3>
              </div>
            </div>
            
                <div class="tooltip-2 row">
                  <h3 class="text-center"><a style="color:#03AAF2" href={{stat.sessionID.id}}>{{stat.sessionID.startDate}}, {{stat.sessionID.startTime}}</a></h3><hr>
                  <span class="tooltiptext-2">Click here to edit your notes!</span>
                </div>
              <div class="row">
                <h4 style="margin:auto">Total Sleep Time:</h4><br><br>
              </div>
                <div class="row" id="rcorners1">
                  {%if stat.tst.hour != 0%}
                    {{stat.tst.hour}} hours and 
                  {%endif%}
                  {%if stat.tst.minute != 0%}
                    {{stat.tst.minute}} minutes and 
                  {%endif%}
                  {%if stat.tst.seconds != 0%}
                    {{stat.tst.second}} seconds
                  {%endif%}
                </div><br><br>
                <div class="circles row">
                  <div class="circle-with-text">
                    {{ stat.avgHR }}
                  </div>
                  <div class="circle-with-text">
                    {{ stat.avgRR }}
                  </div>
                  <div class="circle-with-text">
                    {%if stat.avgHRdip == -1%}
                      Average HR Dip: Not enough data to calculate HR Dip. Please record a sleep session for longer than 1 minute
                    {%else%}
                      {{ stat.avgHRdip }}
                    {%endif%}
                  </div>
                </div>

                <div class="row">
                  <h4 class="col-3">Average HR</h4>
                  <h4 class="col-3">Average RR</h4>
                  <h4 class="col-3">Average HR Dip</h4>
                </div><br>

                <div class="circles row">
                  <div class="circle-with-text">
                    {{ stat.minHR }}
                  </div>
                  <div class="circle-with-text">
                    {{ stat.maxHR }}
                  </div>
                  <div class="circle-with-text">
                    {{ stat.minRR }}
                  </div>
                  <div class="circle-with-text">
                    {{ stat.avgRR }}
                  </div>
                </div>
              
                <div class="row">
                  <h4 class="col-3">Min HR</h4>
                  <h4 class="col-3">Max HR</h4>
                  <h4 class="col-3">Min RR</h4>
                  <h4 class="col-3">Max RR</h4>
                </div><br><br>

                <div class="row">
                  <h4>Your Notes:</h3>
                </div><br>

                <div class="row">
                  <div id="rcorners2">
                    Sleep Quality: <br><br>
                    {{stat.sleepQuality}}
                </div>
                <div id="rcorners2">
                  Sleep Disruptions: <br><br>
                  {{stat.numSleepDisruptions}}
              </div>
              <div id="rcorners2">
                Sleep Notes: <br>
                {{stat.sleepNotes}}
            </div>
                </div><br><br><br>
            
          </div>
       
            
        </div>
      {%else%}
        <p style="color:white">no statistics for this day</p>
      {%endif%}
    {% endif %}
  </div>

  {% endblock %}
